<?xml version="1.0" encoding="UTF-8" standalone="no"?><talendfile:ProcessType xmlns:talendfile="platform:/resource/org.talend.model/model/TalendFile.xsd" xmlns:xmi="http://www.omg.org/XMI" defaultContext="Default" jobType="Standard" xmi:version="2.0">
  <context confirmationNeeded="false" name="Default">
    <contextParameter comment="" internalId="_1G_s0BVzEeyuW89bPHsnhQ" name="Aurora_Port" prompt="Aurora_Port?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="19999"/>
    <contextParameter comment="" internalId="_1G_s0RVzEeyuW89bPHsnhQ" name="Aurora_Server" prompt="Aurora_Server?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="localhost"/>
    <contextParameter comment="" internalId="_1G_s0hVzEeyuW89bPHsnhQ" name="Aurora_AdditionalParams" prompt="Aurora_AdditionalParams?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value=""/>
    <contextParameter comment="" internalId="_1G_s0xVzEeyuW89bPHsnhQ" name="Aurora_Database" prompt="Aurora_Database?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="DataTrax"/>
    <contextParameter comment="" internalId="_1G_s1BVzEeyuW89bPHsnhQ" name="Aurora_Password" prompt="Aurora_Password?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_Password" value="enc:system.encryption.key.v1:dQeyu+mwaiPW0vtSQFNa65BCvUrgghAzlScOmRh3xR3tA9nfJXIdaHucP3mG8T3n"/>
    <contextParameter comment="" internalId="_1G_s1RVzEeyuW89bPHsnhQ" name="Aurora_Schema" prompt="Aurora_Schema?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="public"/>
    <contextParameter comment="" internalId="_1G_s1hVzEeyuW89bPHsnhQ" name="Aurora_Login" prompt="Aurora_Login?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xynadmin"/>
  </context>
  <context confirmationNeeded="false" name="Development">
    <contextParameter comment="" internalId="_1G_s1xVzEeyuW89bPHsnhQ" name="Aurora_Port" prompt="Aurora_Port?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="5432"/>
    <contextParameter comment="" internalId="_1G_s2BVzEeyuW89bPHsnhQ" name="Aurora_Server" prompt="Aurora_Server?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xyndbcluster.cluster-cilo6pqeze5v.us-east-1.rds.amazonaws.com"/>
    <contextParameter comment="" internalId="_1G_s2RVzEeyuW89bPHsnhQ" name="Aurora_AdditionalParams" prompt="Aurora_AdditionalParams?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value=""/>
    <contextParameter comment="" internalId="_1G_s2hVzEeyuW89bPHsnhQ" name="Aurora_Database" prompt="Aurora_Database?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="DataTrax"/>
    <contextParameter comment="" internalId="_1G_s2xVzEeyuW89bPHsnhQ" name="Aurora_Password" prompt="Aurora_Password?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_Password" value="enc:system.encryption.key.v1:el6qSX4D+1lCC+vVA31p7tVViBv35E0TrrgjlyyRYB+2yNfqJ1ubnAAjVze5ExPj"/>
    <contextParameter comment="" internalId="_1G_s3BVzEeyuW89bPHsnhQ" name="Aurora_Schema" prompt="Aurora_Schema?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="public"/>
    <contextParameter comment="" internalId="_1G_s3RVzEeyuW89bPHsnhQ" name="Aurora_Login" prompt="Aurora_Login?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xynadmin"/>
  </context>
  <context confirmationNeeded="false" name="Production">
    <contextParameter comment="" internalId="_1G_s3hVzEeyuW89bPHsnhQ" name="Aurora_Port" prompt="Aurora_Port?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="5432"/>
    <contextParameter comment="" internalId="_1G_s3xVzEeyuW89bPHsnhQ" name="Aurora_Server" prompt="Aurora_Server?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xyndbcluster.cluster-c5lyjxktqflt.us-east-1.rds.amazonaws.com"/>
    <contextParameter comment="" internalId="_1G_s4BVzEeyuW89bPHsnhQ" name="Aurora_AdditionalParams" prompt="Aurora_AdditionalParams?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value=""/>
    <contextParameter comment="" internalId="_1G_s4RVzEeyuW89bPHsnhQ" name="Aurora_Database" prompt="Aurora_Database?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="DataTrax"/>
    <contextParameter comment="" internalId="_1G_s4hVzEeyuW89bPHsnhQ" name="Aurora_Password" prompt="Aurora_Password?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_Password" value="enc:system.encryption.key.v1:BWThUi5xI/6vj3skgApt3VAr25US0guPrqlOAIJ1oaUDnXryxsy9rwginKUMiDTI"/>
    <contextParameter comment="" internalId="_1G_s4xVzEeyuW89bPHsnhQ" name="Aurora_Schema" prompt="Aurora_Schema?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="public"/>
    <contextParameter comment="" internalId="_1G_s5BVzEeyuW89bPHsnhQ" name="Aurora_Login" prompt="Aurora_Login?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xynadmin"/>
  </context>
  <context confirmationNeeded="false" name="DefaultProduction">
    <contextParameter comment="" internalId="_1G_s5RVzEeyuW89bPHsnhQ" name="Aurora_Port" prompt="Aurora_Port?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="19997"/>
    <contextParameter comment="" internalId="_1G_s5hVzEeyuW89bPHsnhQ" name="Aurora_Server" prompt="Aurora_Server?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="localhost"/>
    <contextParameter comment="" internalId="_1G_s5xVzEeyuW89bPHsnhQ" name="Aurora_AdditionalParams" prompt="Aurora_AdditionalParams?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value=""/>
    <contextParameter comment="" internalId="_1G_s6BVzEeyuW89bPHsnhQ" name="Aurora_Database" prompt="Aurora_Database?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="DataTrax"/>
    <contextParameter comment="" internalId="_1G_s6RVzEeyuW89bPHsnhQ" name="Aurora_Password" prompt="Aurora_Password?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_Password" value="enc:system.encryption.key.v1:wBSSSiz+e+o55Jl15ohVaWAj9HaCYrCPTKLOWyaN97SSRSQqqYCVcmAjOaTqS2sP"/>
    <contextParameter comment="" internalId="_1G_s6hVzEeyuW89bPHsnhQ" name="Aurora_Schema" prompt="Aurora_Schema?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="public"/>
    <contextParameter comment="" internalId="_1G_s6xVzEeyuW89bPHsnhQ" name="Aurora_Login" prompt="Aurora_Login?" promptNeeded="false" repositoryContextId="_l2ms0GS3EeuTn6xEN4xmUg" type="id_String" value="xynadmin"/>
  </context>
  <parameters>
    <elementParameter field="CLOSED_LIST" name="LOG4J_RUN_LEVEL" show="false" value="Info"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_X" show="false" value="0"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_Y" show="false" value="0"/>
    <elementParameter field="TEXT" name="REPOSITORY_CONNECTION_ID" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_PROPERTY_TYPENAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_DISTRIBUTION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_VERSION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USERNAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_GROUP" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USE_KEYTAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KT_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KEY_TAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_OO_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_END_POINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_JOB_TRACKER_ENDPOINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_END_POINT" show="false" value=""/>
    <elementParameter field="CHECK" name="IMPLICITCONTEXT_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="STATANDLOG_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="MULTI_THREAD_EXECATION" value="false"/>
    <elementParameter field="TEXT" name="PARALLELIZE_UNIT_SIZE" value="25000"/>
    <elementParameter field="CHECK" name="IMPLICIT_TCONTEXTLOAD" value="false"/>
    <elementParameter field="RADIO" name="FROM_FILE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="RADIO" name="FROM_DATABASE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="FILE" name="IMPLICIT_TCONTEXTLOAD_FILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="FIELDSEPARATOR" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="OVERRIDE_ENCODING_FLAG" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="OVERRIDE_ENCODING_IN_EXTRA" show="false" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="OVERRIDE_ENCODING_IN_EXTRA:ENCODING_TYPE" show="false" value="ISO-8859-15"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="TEXT" name="URL_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR_IMPLICIT_CONTEXT" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS_IMPLICIT_CONTEXT" show="false" value="enc:system.encryption.key.v1:5YTHCKNHyAHsIvPZH1MB9ug8fbaGP/QIEz7YBFfB"/>
    <elementParameter field="FILE" name="DBFILE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="DBTABLE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="QUERY_CONDITION_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="LOAD_NEW_VARIABLE" show="false" value="Warning"/>
    <elementParameter field="CLOSED_LIST" name="NOT_LOAD_OLD_VARIABLE" show="false" value="Warning"/>
    <elementParameter field="CHECK" name="PRINT_OPERATIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_ERROR" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_WARNINGS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_INFO" show="false" value="false"/>
    <elementParameter field="CHECK" name="ON_STATCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_LOGCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_METERCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_CONSOLE_FLAG" show="false" value="false"/>
    <elementParameter field="CHECK" name="ON_FILES_FLAG" show="false" value="false"/>
    <elementParameter field="DIRECTORY" name="FILE_PATH" show="false" value="&quot;C:/Talend/Talend-Studio-20200219_1130-V7.3.1/workspace/.metadata&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_STATS" show="false" value="&quot;stats_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_LOGS" show="false" value="&quot;logs_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_METTER" show="false" value="&quot;meter_file.txt&quot;"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" show="false" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="ON_DATABASE_FLAG" show="false" value="false"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE" show="false" value="tJDBCOutput"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="ORACLE_12"/>
    <elementParameter field="TEXT" name="URL" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DATASOURCE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:BF9ExiEiOjkfb7UgP7dkG3q9ov9Ktm5NIJF90EWw"/>
    <elementParameter field="FILE" name="DBFILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_STATS" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_LOGS" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_METER" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="CATCH_RUNTIME_ERRORS" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_ERRORS" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_WARNING" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_REALTIME_STATS" show="false" value="false"/>
    <elementParameter field="TEXT" name="HEADERFOOTER_HEADERID" show="false" value=""/>
    <elementParameter field="CHECK" name="HEADER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="HEADER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_IMPORT" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADERFOOTER_FOOTERID" show="false" value=""/>
    <elementParameter field="CHECK" name="FOOTER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="FOOTER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_IMPORT" show="false" value=""/>
    <routinesParameter id="_9MPP40CvEeu3bLVe3VddqA" name="DataOperation"/>
    <routinesParameter id="_9OU6kECvEeu3bLVe3VddqA" name="Mathematical"/>
    <routinesParameter id="_9Ow_cECvEeu3bLVe3VddqA" name="Numeric"/>
    <routinesParameter id="_9O6wdkCvEeu3bLVe3VddqA" name="Relational"/>
    <routinesParameter id="_9QZ-NkCvEeu3bLVe3VddqA" name="SQLike"/>
    <routinesParameter id="_9PNrYECvEeu3bLVe3VddqA" name="StringHandling"/>
    <routinesParameter id="_9PhNYECvEeu3bLVe3VddqA" name="TalendDataGenerator"/>
    <routinesParameter id="_9PqXVkCvEeu3bLVe3VddqA" name="TalendDate"/>
    <routinesParameter id="_9QQ0QECvEeu3bLVe3VddqA" name="TalendStringUtil"/>
    <routinesParameter id="_9P9SRkCvEeu3bLVe3VddqA" name="TalendString"/>
  </parameters>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:H7oTbpa1Z9LTTGfxFR39qcI4ZgVxzhRVZstftydZZDaLQxFnoswGpVnK4qc9OA532Xsy"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;&#9;order_activity.account_id,&#13;&#10;    order_activity.activity_date,&#13;&#10;    date_trunc('month', order_activity.activity_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'order' AS activity,&#13;&#10;    'basic' AS activity_category,&#13;&#10;    order_activity.account_type AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;THEN EXTRACT(year from age(order_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(order_activity.activity_date, dst.entry_date))&#13;&#10;        --THEN ROUND(MONTHS_BETWEEN(date_trunc('month', order_activity.activity_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;THEN EXTRACT(year from age(order_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(order_activity.activity_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;THEN EXTRACT(year from age(order_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(order_activity.activity_date, dst.entry_date))&#13;&#10;        ELSE --ROUND(MONTHS_BETWEEN(date_trunc('month', order_activity.activity_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;&#9;&#9;&#9; EXTRACT(year from age(order_activity.activity_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(order_activity.activity_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;&#9;(CAST (order_activity.activity_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;    --DATE_DIFF('day', dst.entry_date, order_activity.activity_date) AS days_after_signup,&#13;&#10;&#9;(CAST (order_activity.activity_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    --DATE_DIFF('day', dst.comm_status_date, order_activity.activity_date) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        dwo.account_id,&#13;&#10;        dwo.commissionable_date AS activity_date,&#13;&#10;        dwo.account_type,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY dwo.account_id, date_trunc('month', dwo.commissionable_date)&#13;&#10;            ORDER BY dwo.commissionable_date, dwo.order_id) AS rn&#13;&#10;    FROM&#13;&#10;        dw_orders dwo&#13;&#10;    WHERE&#13;&#10;        dwo.order_status BETWEEN 2 AND 8&#13;&#10;        AND dwo.is_fraud IS FALSE&#13;&#10;        AND dwo.account_id &gt; 5&#13;&#10;        AND (dwo.qualifying_volume - COALESCE(dwo.in_period_return_qualifying_volume, 0) &gt; 0)&#13;&#10;        OR (&#13;&#10;            dwo.qualifying_volume = 0&#13;&#10;            AND dwo.membership_amt_usd &gt; 0)&#13;&#10;    ORDER BY&#13;&#10;        dwo.account_id,&#13;&#10;        dwo.commissionable_date&#13;&#10;    ) order_activity&#13;&#10;    INNER JOIN dstdb dst ON order_activity.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON order_activity.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'order'&#13;&#10;    LEFT JOIN bwtdb bwt ON order_activity.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(order_activity.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    order_activity.rn = 1&#13;&#10;&#9;AND order_activity.activity_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;--    AND order_activity.activity_date &gt;= date_add('month', -1, date_trunc('month', CURRENT_DATE))&#13;&#10;ORDER BY&#13;&#10;    order_activity.account_id,&#13;&#10;    order_activity.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_orders"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_1">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:wshqdAvY9oaZ8mxW72F5g9lPn0RWAQirN2vgdE0V0TBCLhJcMy0uyjuW/1xlnsJ4JlqJ"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_1">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_2"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:ioLg58DU9+HSzGhzDurfBtUNfjdpO5qRbY53TbqUVRanuMrHOLFIwKwCZHroDfF5OB+N"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    enroll_activity.account_sponsor_id AS account_id,&#13;&#10;    enroll_activity.activity_date,&#13;&#10;    date_trunc('month', enroll_activity.activity_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    CASE&#13;&#10;        WHEN enroll_activity.rn = 1 THEN 'sponsored 1'&#13;&#10;        WHEN enroll_activity.rn = 2 THEN 'sponsored 2'&#13;&#10;        WHEN enroll_activity.rn = 3 THEN 'sponsored 3'&#13;&#10;    END AS activity,&#13;&#10;    CASE&#13;&#10;        WHEN enroll_activity.rn = 1 THEN 'basic'&#13;&#10;        WHEN enroll_activity.rn = 2 THEN 'advanced'&#13;&#10;        WHEN enroll_activity.rn = 3 THEN 'business building'&#13;&#10;    END AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.account_type&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(enroll_activity.activity_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;&#9;(CAST (enroll_activity.activity_date as date) - CAST (dst.src_created_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (enroll_activity.activity_date as date) - CAST (dst.comm_eligible_date as date)) AS days_after_comm_eligible,&#13;&#10;    --DATE_DIFF('day', dst.src_created_date, enroll_activity.activity_date) AS days_after_signup,&#13;&#10;    --DATE_DIFF('day', dst.comm_eligible_date, enroll_activity.activity_date) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        month_first_enrollee.account_sponsor_id,&#13;&#10;        month_first_enrollee.activity_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY month_first_enrollee.account_sponsor_id,&#13;&#10;        date_trunc('month', month_first_enrollee.activity_date) ORDER BY month_first_enrollee.activity_date) AS rn&#13;&#10;    FROM (&#13;&#10;        SELECT&#13;&#10;            dweh.account_sponsor_id,&#13;&#10;            dweh.account_id,&#13;&#10;--            CASE WHEN COALESCE(dwo1.commissionable_date, '1900-01-01') &gt;= DATE_ADD('month', -1, dweh.effective_from_dtz_pt) THEN dwo1.commissionable_date ELSE dweh.effective_from_dtz_pt::DATE END AS activity_date&#13;&#10;            CASE WHEN COALESCE(dwo1.commissionable_date, '1900-01-01') &gt;= dweh.effective_from_dtz_pt  - interval '1 month'  &#13;&#10;&#9;&#9;&#9;&#9;THEN dwo1.commissionable_date &#13;&#10;&#9;&#9;&#9;&#9;ELSE dweh.effective_from_dtz_pt::DATE &#13;&#10;&#9;&#9;&#9;END AS activity_date&#13;&#10;        FROM (&#13;&#10;            SELECT&#13;&#10;                account_sponsor_id,&#13;&#10;                account_id,&#13;&#10;                effective_from_dtz_pt,&#13;&#10;                ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY effective_from_dtz_pt) AS rn&#13;&#10;            FROM&#13;&#10;                dw_enrollment_history&#13;&#10;            WHERE&#13;&#10;                slevel = 1&#13;&#10;                AND account_sponsor_id &gt; 5&#13;&#10;            ) dweh&#13;&#10;            LEFT JOIN (&#13;&#10;                SELECT&#13;&#10;                    account_id,&#13;&#10;                    commissionable_date&#13;&#10;                FROM&#13;&#10;                    dw_orders&#13;&#10;                WHERE&#13;&#10;                    order_type = 'initial'&#13;&#10;                    AND order_status BETWEEN 2 AND 8&#13;&#10;                    AND is_fraud IS FALSE&#13;&#10;                ) dwo1 ON dweh.account_id = dwo1.account_id&#13;&#10;        WHERE&#13;&#10;            dweh.rn = 1&#13;&#10;        ) month_first_enrollee&#13;&#10;    ) enroll_activity&#13;&#10;    INNER JOIN dw_accounts dst ON enroll_activity.account_sponsor_id = dst.account_id AND dst.src_created_date &lt;= CURRENT_DATE + INTERVAL '1 day'&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;    ) initial_order ON enroll_activity.account_sponsor_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON enroll_activity.account_sponsor_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', enroll_activity.activity_date) = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity =&#13;&#10;        CASE&#13;&#10;            WHEN enroll_activity.rn = 1 THEN 'sponsored 1'&#13;&#10;            WHEN enroll_activity.rn = 2 THEN 'sponsored 2'&#13;&#10;            WHEN enroll_activity.rn = 3 THEN 'sponsored 3'&#13;&#10;        END&#13;&#10;    LEFT JOIN bwtdb bwt ON enroll_activity.account_sponsor_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(enroll_activity.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    enroll_activity.rn &lt;= 3&#13;&#10;&#9;AND enroll_activity.activity_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;&#13;&#10;ORDER BY&#13;&#10;    enroll_activity.account_sponsor_id,&#13;&#10;    enroll_activity.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_sponsored"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_2">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_2"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:KlJBjRjEOFp9+kpb9vxRiMhWAhpgsR5KNlGu/PIP59lnJmizebC/IPRZaqSC9u5qNGc7"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_2">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_3"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:79mg9/ZzQ0jThNRqrwLinEZAEwzE6bTCcJCqA6+jolYOpYS5NpkkencmvUDb4EgzqrWF"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    dwxbe.dist_id AS account_id,&#13;&#10;    dwxbe.paid_date AS activity_date,&#13;&#10;    date_trunc('month', dwxbe.paid_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'xtreme builder' AS activity,&#13;&#10;    'outcome' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwxbe.paid_date, dst.entry_date)*12) + EXTRACT(month from age(dwxbe.paid_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwxbe.paid_date, dst.entry_date)*12) + EXTRACT(month from age(dwxbe.paid_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwxbe.paid_date, dst.entry_date)*12) + EXTRACT(month from age(dwxbe.paid_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(dwxbe.paid_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(dwxbe.paid_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwxbe.paid_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwxbe.paid_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwxbe.paid_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', dwxbe.paid_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;&#9;(CAST (dwxbe.paid_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (dwxbe.paid_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, dwxbe.paid_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, dwxbe.paid_date) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM&#13;&#10;    dw_xtreme_bldr_earners dwxbe&#13;&#10;    INNER JOIN dstdb dst ON dwxbe.dist_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON dwxbe.dist_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON dwxbe.dist_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', dwxbe.paid_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'xtreme builder'&#13;&#10;    LEFT JOIN bwtdb bwt ON dwxbe.dist_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(dwxbe.paid_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    date_trunc('month', dwxbe.paid_date) = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;&#13;&#10;ORDER BY&#13;&#10;    dwxbe.dist_id,&#13;&#10;    dwxbe.paid_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_3">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_3"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:A2KgB911VZjzd7GdeDrWyFfg+IKv6q+MZlaDFhKPjgf+URAJqfox81NsTnw21aJCxAjf"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_3">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_4"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:HuokGT1H8mQJVen8GVX/C0gsnJZxCBk7G08hzHssKqQCjA7WknN/cdxAvD3LwJthiq7Y"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    dwcm.account_id,&#13;&#10;    ((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE) + interval '1 month' - interval '1 day' AS activity_date,&#13;&#10;--    DATEADD('day', -1, DATEADD('month', 1, (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE)::DATE)::DATE AS activity_date,&#13;&#10;    (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'qualified 120' AS activity,&#13;&#10;    CASE bwt.status&#13;&#10;        WHEN 'M' THEN 'advanced'&#13;&#10;        ELSE 'basic'&#13;&#10;    END AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, initial_order.commissionable_date)*12) + EXTRACT(month from age((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE) AS days_after_comm_eligible,&#13;&#10;&#9;((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;((CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM&#13;&#10;    dw_comm_monthly dwcm&#13;&#10;    INNER JOIN bwtdb bwt ON dwcm.account_id = bwt.dist_id AND dwcm.dw_pv_date = bwt.dw_pv_date&#13;&#10;    INNER JOIN dstdb dst ON dwcm.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON dwcm.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON dwcm.account_id = monthly_order.account_id&#13;&#10;            AND (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'qualified 120'&#13;&#10;WHERE&#13;&#10;    dwcm.qualified_120 IS TRUE&#13;&#10;    AND dwcm.account_id &gt; 5&#13;&#10;    AND (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    dwcm.account_id,&#13;&#10;    (CAST(dwcm.dw_pv_date AS VARCHAR(6)) || '01')::DATE&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_refer_update"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_4">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_4"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:SgS4nQPR9LzK+otdz0XQ/QB6A2fmcorCVKhbyTluJQ8zhZhmt++vSXH0VBA+UzHKbIBk"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_4">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_5"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:MvvZcEg3fgTzQyP81M0Lg7AlSU9xHOflQV2tIz0Bh8gYo32YJBfmh9yGF2JhXXZAvxvC"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    dwe.account_id AS account_id,&#13;&#10;    dwe.attend_date AS activity_date,&#13;&#10;    date_trunc('month', dwe.attend_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    CONCAT('event ', lower(dwed.event_name)) AS activity,&#13;&#10;    'advanced' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwe.attend_date, dst.entry_date)*12) + EXTRACT(month from age(dwe.attend_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwe.attend_date, dst.entry_date)*12) + EXTRACT(month from age(dwe.attend_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(dwe.attend_date, dst.entry_date)*12) + EXTRACT(month from age(dwe.attend_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(dwe.attend_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(dwe.attend_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwe.attend_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwe.attend_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', dwe.attend_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', dwe.attend_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, dwe.attend_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, dwe.attend_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (dwe.attend_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (dwe.attend_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM&#13;&#10;    dw_eventmaster dwe&#13;&#10;    INNER JOIN dw_event_description dwed ON dwe.event_id = dwed.event_id&#13;&#10;    INNER JOIN dstdb dst ON dwe.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON dwe.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON dwe.account_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', dwe.attend_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = CONCAT('event ', lower(dwed.event_name))&#13;&#10;    LEFT JOIN bwtdb bwt ON dwe.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(dwe.attend_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    dwe.attend_date IS NOT NULL&#13;&#10;    AND date_trunc('month', dwe.attend_date) = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    dwe.account_id,&#13;&#10;    dwe.attend_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_event"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_5">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_5"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:O+fiVuS0Grr28zjQ2+fRuNChJvQC9kvylX+jHXHVLuO+wProQPoXz/uGSXZTVlq985Bo"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_5">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="96" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_6"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:hZw/qXZOAiA/VhU+EEBFYyWir9CWEqMKmCCf9wXIxw+WltdHEL+mtrBtuaXQgnycjArk"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;SELECT &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;account_id\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_date\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_month\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_id\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_category\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;retained_account_type\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;months_after_signup\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;days_after_signup\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;days_after_eligible\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;lifetime_rank\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;paid_rank\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;dw_updated_dtz\&quot;&#10;FROM \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_rank_advancement"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_6">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="288" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_6"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:zeCxk5X/5sMzizbGGL7HWaVAYtNIQuWiRXsQSx0uIqUvXljRYrYUGQipFTFLuMxGP4b1"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_6">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_7"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:yWoOgQpgWkxgVnCez5d8u+FLz3kCYh/xBDm2w/6Xy2dFHoIvTRKGR5xIp5jycZV9aCjg"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    first_check_activity.account_id,&#13;&#10;    first_check_activity.activity_date,&#13;&#10;    date_trunc('month', first_check_activity.activity_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'first comm check' AS activity,&#13;&#10;    'outcome' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_check_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(first_check_activity.activity_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_check_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(first_check_activity.activity_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_check_activity.activity_date, dst.entry_date)*12) + EXTRACT(month from age(first_check_activity.activity_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(first_check_activity.activity_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(first_check_activity.activity_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_check_activity.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_check_activity.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--       WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--       THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_check_activity.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', first_check_activity.activity_date)::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, first_check_activity.activity_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, first_check_activity.activity_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (first_check_activity.activity_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (first_check_activity.activity_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        btr.dist_id AS account_id,&#13;&#10;        --CONVERT(DATETIME, btr.group_number::VARCHAR(8))::DATE AS activity_date,&#13;&#10;        (btr.group_number::VARCHAR(8))::DATE AS activity_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY btr.dist_id ORDER BY btr.group_number) AS rn&#13;&#10;    FROM&#13;&#10;        btrdaily btr&#13;&#10;    WHERE&#13;&#10;        btr.bonus &gt; 0&#13;&#10;        AND btr.dist_id &gt; 5&#13;&#10;    ) first_check_activity&#13;&#10;    INNER JOIN dstdb dst ON first_check_activity.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON first_check_activity.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON first_check_activity.account_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', first_check_activity.activity_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'first comm check'&#13;&#10;    LEFT JOIN bwtdb bwt ON first_check_activity.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(first_check_activity.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    first_check_activity.rn = 1&#13;&#10;    AND first_check_activity.activity_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    first_check_activity.account_id,&#13;&#10;    first_check_activity.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_first_comm"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_7">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_7"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:ZhEB2R7nsQ76ClZm1+Uis+nR2yXuCdQmBOnneuAqTyA4R41qvWgN7iK07k4g3VBkmlsw"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_7">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_8"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:Ir9bbcls3niASl4H+GCatCyHXO8pl9X6g9t1jk8NuPuNNvPlprm+X0EZxegIRW07KHlV"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    break_even.account_id,&#13;&#10;    break_even.activity_date,&#13;&#10;    date_trunc('month', break_even.activity_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'break even' AS activity,&#13;&#10;    'outcome' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(break_even.activity_date, dst.entry_date)*12) + EXTRACT(month from age(break_even.activity_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(break_even.activity_date, dst.entry_date)*12) + EXTRACT(month from age(break_even.activity_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(break_even.activity_date, dst.entry_date)*12) + EXTRACT(month from age(break_even.activity_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(break_even.activity_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(break_even.activity_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', break_even.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', break_even.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', break_even.activity_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', break_even.activity_date)::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;&#9;(CAST (break_even.activity_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (break_even.activity_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, break_even.activity_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, break_even.activity_date) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        total_spent.account_id,&#13;&#10;        total_spent.spend_date,&#13;&#10;        total_earnings.activity_date,&#13;&#10;        total_spent.total_spent,&#13;&#10;        total_earnings.running_total,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY total_spent.account_id, total_spent.spend_date ORDER BY total_earnings.activity_date, total_earnings.running_total) AS rn&#13;&#10;    FROM (&#13;&#10;        SELECT&#13;&#10;            account_id,&#13;&#10;            date_trunc('month', commissionable_date)::DATE AS spend_date,&#13;&#10;            SUM(order_total_local) AS total_spent&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            is_fraud IS FALSE&#13;&#10;            AND order_status BETWEEN 2 AND 8&#13;&#10;        GROUP BY&#13;&#10;            account_id,&#13;&#10;            date_trunc('month', commissionable_date)&#13;&#10;        ) total_spent&#13;&#10;        INNER JOIN (&#13;&#10;            SELECT&#13;&#10;                earnings.dist_id AS account_id,&#13;&#10;                earnings.activity_date,&#13;&#10;                SUM(earnings.earnings) OVER (PARTITION BY earnings.dist_id, date_trunc('month', earnings.activity_date) ORDER BY earnings.activity_date ROWS UNBOUNDED PRECEDING) AS running_total&#13;&#10;            FROM (&#13;&#10;                SELECT&#13;&#10;                    btr.dist_id,&#13;&#10;                    (btr.group_number::VARCHAR(8))::DATE AS activity_date,&#13;&#10;                    SUM(btr.bonus) AS earnings&#13;&#10;                FROM&#13;&#10;                    btrdaily btr&#13;&#10;                WHERE&#13;&#10;                    btr.bonus &gt; 0&#13;&#10;                    AND btr.dist_id &gt; 5&#13;&#10;                GROUP BY&#13;&#10;                    btr.dist_id,&#13;&#10;                    btr.group_number&#13;&#10;                ORDER BY&#13;&#10;                    (btr.group_number::VARCHAR(8))::DATE&#13;&#10;                ) earnings&#13;&#10;            GROUP BY&#13;&#10;                earnings.dist_id,&#13;&#10;                earnings.activity_date,&#13;&#10;                earnings.earnings&#13;&#10;            ) total_earnings ON total_spent.account_id = total_earnings.account_id AND total_spent.total_spent &lt;= total_earnings.running_total&#13;&#10;                AND total_spent.spend_date = date_trunc('month', total_earnings.activity_date)&#13;&#10;    ORDER BY&#13;&#10;        total_earnings.account_id,&#13;&#10;        total_earnings.activity_date,&#13;&#10;        total_earnings.running_total&#13;&#10;    ) break_even&#13;&#10;    INNER JOIN dstdb dst ON break_even.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON break_even.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON break_even.account_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', break_even.activity_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'break even'&#13;&#10;    LEFT JOIN bwtdb bwt ON break_even.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(break_even.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    break_even.rn = 1&#13;&#10;    AND date_trunc('month', break_even.activity_date) = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    break_even.account_id,&#13;&#10;    break_even.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_breakeven"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_8">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_8"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:XtauCsvlviMNXZPXmiWUsTnz6rT86HRz54LJIpVBALAiCfNTg7AzsxQOGnUKWJUp4VtP"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_8">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_9"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:rYvo84JDVJNlGQ0dHYAyhLEH3kNr9XPIjawNKob938VVaVD6FmWfMBxNbeL74oVUBbHy"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    dwcm.account_id,&#13;&#10;    --CONVERT(DATETIME, dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE AS activity_date,&#13;&#10;    (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE AS activity_date,&#13;&#10;    (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    CASE dwcm.paid_rank&#13;&#10;        WHEN 2 THEN 'primary bonus mgr'&#13;&#10;        WHEN 3 THEN 'primary bonus silver mgr'&#13;&#10;        WHEN 4 THEN 'primary bonus gold mgr'&#13;&#10;        WHEN 5 THEN 'primary bonus platinum mgr'&#13;&#10;        WHEN 6 THEN 'primary bonus dir'&#13;&#10;        WHEN 7 THEN 'primary bonus silver dir'&#13;&#10;        WHEN 8 THEN 'primary bonus gold dir'&#13;&#10;        WHEN 9 THEN 'primary bonus platinum dir'&#13;&#10;        WHEN 10 THEN 'primary bonus exe'&#13;&#10;        WHEN 11 THEN 'primary bonus silver exe'&#13;&#10;        WHEN 12 THEN 'primary bonus gold exe'&#13;&#10;        WHEN 13 THEN 'primary bonus platinum exe'&#13;&#10;        WHEN 14 THEN 'primary bonus amb'&#13;&#10;        WHEN 15 THEN 'primary bonus silver amb'&#13;&#10;        WHEN 16 THEN 'primary bonus gold amb'&#13;&#10;        WHEN 17 THEN 'primary bonus platinum amb'&#13;&#10;    END AS activity,&#13;&#10;    'outcome' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, initial_order.commissionable_date)*12) + EXTRACT(month from age((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE) AS days_after_comm_eligible,&#13;&#10;&#9;((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE) - CAST (dst.entry_date as date) AS days_after_signup,&#13;&#10;&#9;((dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE) - CAST (dst.comm_status_date as date) AS days_after_comm_eligible,&#13;&#10;     bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM&#13;&#10;    dw_comm_monthly dwcm&#13;&#10;    INNER JOIN dstdb dst ON dwcm.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON dwcm.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON dwcm.account_id = monthly_order.account_id&#13;&#10;            AND (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity =&#13;&#10;        CASE dwcm.end_rank&#13;&#10;            WHEN 2 THEN 'primary bonus mgr'&#13;&#10;            WHEN 3 THEN 'primary bonus silver mgr'&#13;&#10;            WHEN 4 THEN 'primary bonus gold mgr'&#13;&#10;            WHEN 5 THEN 'primary bonus platinum mgr'&#13;&#10;            WHEN 6 THEN 'primary bonus dir'&#13;&#10;            WHEN 7 THEN 'primary bonus silver dir'&#13;&#10;            WHEN 8 THEN 'primary bonus gold dir'&#13;&#10;            WHEN 9 THEN 'primary bonus platinum dir'&#13;&#10;            WHEN 10 THEN 'primary bonus exe'&#13;&#10;            WHEN 11 THEN 'primary bonus silver exe'&#13;&#10;            WHEN 12 THEN 'primary bonus gold exe'&#13;&#10;            WHEN 13 THEN 'primary bonus platinum exe'&#13;&#10;            WHEN 14 THEN 'primary bonus amb'&#13;&#10;            WHEN 15 THEN 'primary bonus silver amb'&#13;&#10;            WHEN 16 THEN 'primary bonus gold amb'&#13;&#10;            WHEN 17 THEN 'primary bonus platinum amb'&#13;&#10;        END&#13;&#10;    LEFT JOIN bwtdb bwt ON dwcm.account_id = bwt.dist_id&#13;&#10;        AND dwcm.dw_pv_date = bwt.dw_pv_date&#13;&#10;WHERE&#13;&#10;    dwcm.mgr_pool_earnings_usd &gt; 0&#13;&#10;    AND dwcm.account_id &gt; 5&#13;&#10;--    AND (dwcm.dw_pv_date::VARCHAR(6) || '01')::DATE = date_add('month', -1, date_trunc('month', CURRENT_DATE))&#13;&#10;ORDER BY&#13;&#10;    dwcm.account_id&#13;&#10;&#9;--, dwcm.dw_pv_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_primary_bonus"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_9">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_9"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:OiQKj17Kb94EgEgBQR1aopFBG08NUUWAyZ7bjoJwOrwIGaV0zw7VqMRfN8Hgfu5C42vB"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_9">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_10"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:6OtOyZX2R6NsVCY/BrdNiHlnrNN8mLwzsg5Y6WCjwDOfTkwMKgo8kSCOkX7Z69u05CPZ"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    btr.account_id,&#13;&#10;    btr.activity_date,&#13;&#10;    btr.activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    CASE btr.bonus_type&#13;&#10;        WHEN 1 THEN 'secondary retail'&#13;&#10;        WHEN 2 THEN 'secondary rapid reward'&#13;&#10;        WHEN 3 THEN 'secondary quickstart'&#13;&#10;        WHEN 4 THEN 'secondary residual'&#13;&#10;    END AS activity,&#13;&#10;    CASE btr.bonus_type&#13;&#10;        WHEN 1 THEN 'outcome'&#13;&#10;        WHEN 2 THEN 'outcome'&#13;&#10;        WHEN 3 THEN 'outcome'&#13;&#10;        WHEN 4 THEN 'outcome'&#13;&#10;    END AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;   CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(btr.activity_month, dst.entry_date)*12) + EXTRACT(month from age(btr.activity_month, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(btr.activity_month, dst.entry_date)*12) + EXTRACT(month from age(btr.activity_month, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(btr.activity_month, dst.entry_date)*12) + EXTRACT(month from age(btr.activity_month, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(btr.activity_month, initial_order.commissionable_date)*12) + EXTRACT(month from age(btr.activity_month, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(btr.activity_month, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(btr.activity_month, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(btr.activity_month, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(btr.activity_month, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, btr.activity_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, btr.activity_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (btr.activity_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (btr.activity_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        dist_id AS account_id,&#13;&#10;        (CAST(group_number AS VARCHAR(8))::DATE)::DATE AS activity_date,&#13;&#10;        date_trunc('month', (CAST(group_number AS VARCHAR(8)))::DATE)::DATE AS activity_month,&#13;&#10;        bonus_type,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY dist_id, bonus_type, date_trunc('month', (CAST(group_number AS VARCHAR(8)))::DATE)::DATE ORDER BY group_number) AS rn&#13;&#10;    FROM&#13;&#10;        btrdaily&#13;&#10;    WHERE&#13;&#10;        dist_id &gt; 5&#13;&#10;    ) btr&#13;&#10;    INNER JOIN dstdb dst ON btr.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON btr.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON btr.account_id = monthly_order.account_id&#13;&#10;            AND btr.activity_month = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity =&#13;&#10;        CASE btr.bonus_type&#13;&#10;            WHEN 1 THEN 'secondary retail'&#13;&#10;            WHEN 2 THEN 'secondary rapid reward'&#13;&#10;            WHEN 3 THEN 'secondary quickstart'&#13;&#10;            WHEN 4 THEN 'secondary residual'&#13;&#10;        END&#13;&#10;    LEFT JOIN bwtdb bwt ON btr.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(btr.activity_month, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    btr.rn = 1&#13;&#10;    AND btr.activity_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    btr.account_id,&#13;&#10;    btr.activity_month&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_secondary_bonus"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_10">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_10"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:HqL/d1iC/boLhPj6IuVeQCaQ6DQUvBn2iGxruxX8PVfsAwLLKpUltQ+u1hsIMlvLLYuL"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_10">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_11"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:Zg3diNpQgb3KqG5brvKtfov5QBme4jAZCVthDyQhrHJU1HYWN+7cbneRWYpss1jdWFu6"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    enroll_activity.account_sponsor_id AS account_id,&#13;&#10;    enroll_activity.activity_date,&#13;&#10;    date_trunc('month', enroll_activity.activity_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'one a week plus one' AS activity,&#13;&#10;    'business building' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.account_type&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;   CASE&#13;&#10;        WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(enroll_activity.activity_date, dst.src_created_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, dst.src_created_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(enroll_activity.activity_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(enroll_activity.activity_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', enroll_activity.activity_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.src_created_date, enroll_activity.activity_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', COALESCE(dst.comm_eligible_date, dst.src_created_date), enroll_activity.activity_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (enroll_activity.activity_date as date) - CAST (dst.src_created_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (dst.src_created_date as date) - CAST (COALESCE(dst.comm_eligible_date, dst.src_created_date) as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        month_first_enrollee.account_sponsor_id,&#13;&#10;        month_first_enrollee.activity_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY month_first_enrollee.account_sponsor_id,&#13;&#10;            date_trunc('month', month_first_enrollee.activity_date) ORDER BY month_first_enrollee.activity_date) AS rn&#13;&#10;    FROM (&#13;&#10;        SELECT&#13;&#10;            dweh.account_sponsor_id,&#13;&#10;            dwo1.account_id,&#13;&#10;            dwo1.commissionable_date AS activity_date&#13;&#10;        FROM&#13;&#10;            dw_orders dwo1&#13;&#10;            INNER JOIN (&#13;&#10;                SELECT&#13;&#10;                    account_sponsor_id,&#13;&#10;                    account_id,&#13;&#10;                    ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY effective_from_dtz_pt) AS rn&#13;&#10;                FROM&#13;&#10;                    dw_enrollment_history&#13;&#10;                WHERE&#13;&#10;                    slevel = 1&#13;&#10;                    AND account_sponsor_id &gt; 5&#13;&#10;                ) dweh ON dwo1.account_id = dweh.account_id AND dweh.rn = 1&#13;&#10;        WHERE&#13;&#10;            dwo1.is_fraud IS FALSE&#13;&#10;            AND dwo1.order_status BETWEEN 2 AND 8&#13;&#10;            AND dwo1.order_type = 'initial'&#13;&#10;        ) month_first_enrollee&#13;&#10;    ) enroll_activity&#13;&#10;    INNER JOIN dw_accounts dst ON enroll_activity.account_sponsor_id = dst.account_id AND dst.src_created_date &lt;= CURRENT_DATE + INTERVAL '1 day'&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON enroll_activity.account_sponsor_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON enroll_activity.account_sponsor_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', enroll_activity.activity_date) = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'one a week plus one'&#13;&#10;    LEFT JOIN bwtdb bwt ON enroll_activity.account_sponsor_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(enroll_activity.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    enroll_activity.rn = 5&#13;&#10;    AND date_trunc('month', enroll_activity.activity_date) = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    enroll_activity.account_sponsor_id,&#13;&#10;    enroll_activity.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_one_a_week_plus_one"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_11">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_11"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:pochTop0/4NF0fpgDXNnx+27VpUx2f22kSQXu6GQ18+aoSaGSpSg9A10M5KAisCvQx+k"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_11">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="512" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_12"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:qCDk2OrnctKQfBfMElr3d6C/T2vgBlnyvPxM0C9J3VcNaQ/Ws6aVGzFB+R2RkTZaqfio"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    first_system.account_id,&#13;&#10;    first_system.commissionable_date AS activity_date,&#13;&#10;    date_trunc('month', first_system.commissionable_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'first system' AS activity,&#13;&#10;    'basic' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;   CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_system.commissionable_date, dst.entry_date)*12) + EXTRACT(month from age(first_system.commissionable_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_system.commissionable_date, dst.entry_date)*12) + EXTRACT(month from age(first_system.commissionable_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_system.commissionable_date, dst.entry_date)*12) + EXTRACT(month from age(first_system.commissionable_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(first_system.commissionable_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(first_system.commissionable_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_system.commissionable_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_system.commissionable_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_system.commissionable_date), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', first_system.commissionable_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, first_system.commissionable_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, first_system.commissionable_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (first_system.commissionable_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (first_system.commissionable_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        dwol.account_id,&#13;&#10;        dwol.commissionable_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY dwol.account_id ORDER BY dwol.commissionable_date, dwol.order_id) AS rn&#13;&#10;    FROM&#13;&#10;        dw_orderlines dwol&#13;&#10;        INNER JOIN dw_product_category_map dwpcm ON dwol.item_code = dwpcm.item_code AND (dwpcm.is_ignite IS TRUE&#13;&#10;            OR dwpcm.is_core IS TRUE OR dwpcm.is_ultimate IS TRUE)&#13;&#10;    WHERE&#13;&#10;        dwol.account_id &gt; 5&#13;&#10;    ) first_system&#13;&#10;    INNER JOIN dstdb dst ON first_system.account_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON first_system.account_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON first_system.account_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', first_system.commissionable_date) = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'first system'&#13;&#10;    LEFT JOIN bwtdb bwt ON first_system.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(first_system.commissionable_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    first_system.rn = 1&#13;&#10;    AND first_system.commissionable_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    first_system.account_id,&#13;&#10;    first_system.commissionable_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_first_system"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_12">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="704" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_12"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:1Ugp/Qt2BJ9SkQcdN9RzhQkaxmgIw5eUX5iHS+cR8/0K6FXsJVOxKI7ETBEsT4twv/eD"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_12">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_13"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:7dO2/forFTtMm3FNC2b9qavHAIbfh5iTChKmqYhkwj6gRgE6yvLKKDPVWnqsUvv3G8Oh"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    upgrade.account_id,&#13;&#10;    upgrade.activity_date,&#13;&#10;    upgrade.activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    upgrade.activity,&#13;&#10;    upgrade.activity_category,&#13;&#10;    upgrade.retained_account_type,&#13;&#10;    upgrade.months_after_signup,&#13;&#10;    upgrade.days_after_signup,&#13;&#10;    upgrade.days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    upgrade.dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        upl.dist_id AS account_id,&#13;&#10;        upl.date_log AS activity_date,&#13;&#10;        date_trunc('month', upl.date_log)::DATE AS activity_month,&#13;&#10;        'upgrade' AS activity,&#13;&#10;        'basic' AS activity_category,&#13;&#10;        CASE&#13;&#10;            WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;            ELSE monthly_order.account_type&#13;&#10;        END AS retained_account_type,&#13;&#10;--        CASE&#13;&#10;--            WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', upl.date_log), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--            WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', upl.date_log), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--            WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', upl.date_log), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--            ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', upl.date_log), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--        END AS months_after_signup,&#13;&#10;        CASE&#13;&#10;            WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;    &#9;THEN EXTRACT(year from age(upl.date_log, dst.entry_date)*12) + EXTRACT(month from age(upl.date_log, dst.entry_date))&#13;&#10;            WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;    THEN EXTRACT(year from age(upl.date_log, dst.entry_date)*12) + EXTRACT(month from age(upl.date_log, dst.entry_date))&#13;&#10;            WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;    THEN EXTRACT(year from age(upl.date_log, dst.entry_date)*12) + EXTRACT(month from age(upl.date_log, dst.entry_date))&#13;&#10;            ELSE &#13;&#10;&#9;&#9;&#9;    EXTRACT(year from age(upl.date_log, initial_order.commissionable_date)*12) + EXTRACT(month from age(upl.date_log, initial_order.commissionable_date))&#13;&#10;        END AS months_after_signup,&#13;&#10;&#9;    (upl.date_log - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;    (upl.date_log - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;&#9;    --DATE_DIFF('day', dst.entry_date, upl.date_log) AS days_after_signup,&#13;&#10;        --DATE_DIFF('day', dst.comm_status_date, upl.date_log) AS days_after_comm_eligible,&#13;&#10;        CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;    FROM (&#13;&#10;        SELECT&#13;&#10;            dist_id,&#13;&#10;            date_log,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY dist_id ORDER BY date_log) AS rn&#13;&#10;        FROM&#13;&#10;            upldb&#13;&#10;        WHERE&#13;&#10;            old_value = 'M'&#13;&#10;            AND new_value = 'D'&#13;&#10;            AND field = 'Dist Status'&#13;&#10;            AND dist_id &gt; 5&#13;&#10;        ) upl&#13;&#10;        INNER JOIN dstdb dst ON upl.dist_id = dst.dist_id&#13;&#10;        LEFT JOIN (&#13;&#10;            SELECT&#13;&#10;                commissionable_date,&#13;&#10;                account_id,&#13;&#10;                ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;            FROM&#13;&#10;                dw_orders&#13;&#10;            WHERE&#13;&#10;                order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;            ORDER BY&#13;&#10;                account_id,&#13;&#10;                commissionable_date&#13;&#10;            ) initial_order ON upl.dist_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;        LEFT JOIN (&#13;&#10;            SELECT&#13;&#10;                commissionable_date,&#13;&#10;                account_id,&#13;&#10;                account_type,&#13;&#10;                ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;            FROM&#13;&#10;                dw_orders&#13;&#10;            WHERE&#13;&#10;                order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;            ORDER BY&#13;&#10;                account_id,&#13;&#10;                commissionable_date&#13;&#10;            ) monthly_order ON upl.dist_id = monthly_order.account_id&#13;&#10;                AND date_trunc('month', upl.date_log) = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;                AND monthly_order.rn = 1&#13;&#10;    WHERE&#13;&#10;        upl.rn = 1&#13;&#10;        --AND DATE_DIFF('day', dst.entry_date, upl.date_log) &gt;= 5&#13;&#10;&#9;    AND (upl.date_log - dst.entry_date) &gt;= 5&#13;&#10;    ORDER BY&#13;&#10;        upl.dist_id,&#13;&#10;        upl.date_log&#13;&#10;    ) upgrade&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = upgrade.activity&#13;&#10;    LEFT JOIN bwtdb bwt ON upgrade.account_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(upgrade.activity_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    upgrade.activity_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    upgrade.activity_date,&#13;&#10;    upgrade.account_id&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_upgrade"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_13">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="64">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_13"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:FBSjqpLDqZnukWjkh3jQ7HxkfYiYdO4uMioSSaDv0FZGQJF5KjgGD6D958IX92la9YFT"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_13">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_14"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:pZbl9suKOFZqH7rapnHR7eipr7lj44oKDFEAzQfPcT5GPFh0reHeAFKrtbvz2piXWwXs"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;SELECT &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;account_id\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_date\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_month\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_id\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;activity_category\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;retained_account_type\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;months_after_signup\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;days_after_signup\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;days_after_eligible\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;lifetime_rank\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;paid_rank\&quot;, &#10;  \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;.\&quot;dw_updated_dtz\&quot;&#10;FROM \&quot;&quot;+context.Aurora_Database+&quot;\&quot;.\&quot;&quot;+context.Aurora_Schema+&quot;\&quot;.\&quot;dw_account_activity\&quot;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_120_pv"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_14">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="192">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_14"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:dF6eSPBm1lx8Udl8nBrCtC0gF/KFNwGPbA41peNW5bZjsLHXJP3e/hZQCINjs8VqM7gs"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_14">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_15"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:Kyek8i8uyRxnGTK9t3peWveCVYWj24eupGI3AbXmwPNtBzwmlQaqqimeiiRNBmE1qIc5"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    bwt.dist_id AS account_id,&#13;&#10;    (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE AS activity_date,&#13;&#10;    date_trunc('month', (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'rank maintained' AS activity,&#13;&#10;    'advanced' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date)*12) + EXTRACT(month from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, initial_order.commissionable_date)*12) + EXTRACT(month from age((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE), date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE) AS days_after_comm_eligible,&#13;&#10;&#9;((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;((CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;     bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM&#13;&#10;    bwtdb bwt&#13;&#10;    INNER JOIN dstdb dst ON bwt.dist_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON bwt.dist_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON bwt.dist_id = monthly_order.account_id&#13;&#10;            AND (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'rank maintained'&#13;&#10;WHERE&#13;&#10;    bwt.dist_id &gt; 5&#13;&#10;    AND bwt.paid_rank = bwt.end_rank&#13;&#10;    AND bwt.paid_rank &gt; 1&#13;&#10;    AND (CAST(bwt.dw_pv_date AS VARCHAR(6)) || '01')::DATE = date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    bwt.dist_id--,&#13;&#10;--    bwt.dw_pv_date&#13;&#10;&quot;&#9;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_rank_maintained"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_15">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_15"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:RsLP6f1Ck72knAuEz+jBF5M2GZrl2Zsz3VTvJldEG7Jl0mhet8R91h4bJ+lHzOaZJ0PV"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_15">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_16"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:VW3yYrHgPCIdzrL7hGSfXMT1x/9VY8LetOEIMf4GZTqsK/Bn9AKnn1EJYPMDagdcAMO8"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    ash.dist_id AS account_id,&#13;&#10;    ash.record_date AS activity_date,&#13;&#10;    date_trunc('month', ash.record_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'subscription added' AS activity,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' AND dst.dist_status = 'D' THEN 'basic'&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = 'D' THEN 'basic'&#13;&#10;        ELSE 'advanced' END AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;   CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.record_date, dst.entry_date)*12) + EXTRACT(month from age(ash.record_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.record_date, dst.entry_date)*12) + EXTRACT(month from age(ash.record_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.record_date, dst.entry_date)*12) + EXTRACT(month from age(ash.record_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(ash.record_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(ash.record_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.record_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.record_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.record_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', ash.record_date)::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, ash.record_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, ash.record_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (ash.record_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (ash.record_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        dist_id,&#13;&#10;        record_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY dist_id, date_trunc('month', record_date) ORDER BY record_date) AS rn&#13;&#10;    FROM&#13;&#10;        ashdb&#13;&#10;    WHERE&#13;&#10;        dist_id &gt; 5&#13;&#10;        AND record_date IS NOT NULL&#13;&#10;    ) ash&#13;&#10;    INNER JOIN dstdb dst ON ash.dist_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON ash.dist_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON ash.dist_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', ash.record_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'subscription added'&#13;&#10;    LEFT JOIN bwtdb bwt ON ash.dist_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(ash.record_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    ash.rn = 1&#13;&#10;    AND ash.record_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;ORDER BY&#13;&#10;    ash.dist_id,&#13;&#10;    ash.record_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_subscription_added_run"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_16">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1152" posY="448">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_16"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:D2c3EoXHFJa+lBmo4vxJSaasbNcVKbF66S5Rpista0Un4cVeCVP21muJ+bkIz5BBwtHj"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_16">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_17"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:aBbg+yVHDyw9AskiL2CUzbNx2xej7FM62qz7cVUjZ4RYCsHkRkSF/GVvalKwMs2G3w1x"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    ash.dist_id AS account_id,&#13;&#10;    ash.delete_date AS activity_date,&#13;&#10;    date_trunc('month', ash.delete_date)::DATE AS activity_month,&#13;&#10;    dwaw.activity_id,&#13;&#10;    'subscription deleted' AS activity,&#13;&#10;    'adverse' AS activity_category,&#13;&#10;    CASE&#13;&#10;        WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.dist_status&#13;&#10;        ELSE monthly_order.account_type&#13;&#10;    END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.delete_date, dst.entry_date)*12) + EXTRACT(month from age(ash.delete_date, dst.entry_date))&#13;&#10;        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.delete_date, dst.entry_date)*12) + EXTRACT(month from age(ash.delete_date, dst.entry_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(ash.delete_date, dst.entry_date)*12) + EXTRACT(month from age(ash.delete_date, dst.entry_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(ash.delete_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(ash.delete_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--    CASE&#13;&#10;--        WHEN dst.entry_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.delete_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN dst.entry_date &lt;= '2015-10-31'&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.delete_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--        THEN ROUND(MONTHS_BETWEEN(date_trunc('month', ash.delete_date)::DATE, date_trunc('month', dst.entry_date)::DATE), 0)&#13;&#10;--        ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', ash.delete_date)::DATE, date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--    END AS months_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.entry_date, ash.delete_date) AS days_after_signup,&#13;&#10;--    DATE_DIFF('day', dst.comm_status_date, ash.delete_date) AS days_after_comm_eligible,&#13;&#10;&#9;(CAST (ash.delete_date as date) - CAST (dst.entry_date as date)) AS days_after_signup,&#13;&#10;&#9;(CAST (ash.delete_date as date) - CAST (dst.comm_status_date as date)) AS days_after_comm_eligible,&#13;&#10;    bwt.end_rank AS lifetime_rank,&#13;&#10;    bwt.paid_rank AS paid_rank,&#13;&#10;    CURRENT_TIMESTAMP AS dw_updated_dtz&#13;&#10;FROM (&#13;&#10;    SELECT&#13;&#10;        dist_id,&#13;&#10;        status,&#13;&#10;        delete_date,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY dist_id, date_trunc('month', delete_date) ORDER BY delete_date) AS rn&#13;&#10;    FROM&#13;&#10;        ashdb&#13;&#10;    WHERE&#13;&#10;        dist_id &gt; 5&#13;&#10;        AND status &lt;&gt; 1&#13;&#10;        AND delete_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;        AND delete_date IS NOT NULL&#13;&#10;    ) ash&#13;&#10;    INNER JOIN dstdb dst ON ash.dist_id = dst.dist_id&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) initial_order ON ash.dist_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    LEFT JOIN (&#13;&#10;        SELECT&#13;&#10;            commissionable_date,&#13;&#10;            account_id,&#13;&#10;            account_type,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;        ORDER BY&#13;&#10;            account_id,&#13;&#10;            commissionable_date&#13;&#10;        ) monthly_order ON ash.dist_id = monthly_order.account_id&#13;&#10;            AND date_trunc('month', ash.delete_date)::DATE = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;            AND monthly_order.rn = 1&#13;&#10;    LEFT JOIN dw_activity_weight dwaw ON dwaw.activity = 'subscription deleted'&#13;&#10;    LEFT JOIN bwtdb bwt ON ash.dist_id = bwt.dist_id&#13;&#10;        AND TO_CHAR(ash.delete_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;WHERE&#13;&#10;    ash.rn = 1&#13;&#10;ORDER BY&#13;&#10;    ash.dist_id,&#13;&#10;    ash.delete_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_subscription_deleted_run"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_17">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="576">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_17"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:Am96uWPkqERE2HEaW5iYiZRWFpUleDA8P/iWvyHYQoMXKrSVkAS2XXCD4MUGd3axQZ4g"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_17">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_18"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:9VACR2syygXkT8C0319mLrCHNLAPGpVDgON+6uGWpCDmPJdP8DByIFXdnqqbpXySUHoR"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;&#13;&#10;SELECT&#13;&#10;&#9;DISTINCT&#13;&#10;    first_activity.account_id,&#13;&#10;    first_activity.activity_date,&#13;&#10;    first_activity.activity_month,&#13;&#10;    first_activity.activity_id,&#13;&#10;    first_activity.activity,&#13;&#10;    first_activity.activity_category,&#13;&#10;    first_activity.retained_account_type,&#13;&#10;    first_activity.months_after_signup,&#13;&#10;    first_activity.days_after_signup,&#13;&#10;    first_activity.days_after_comm_eligible,&#13;&#10;    first_activity.lifetime_rank,&#13;&#10;    first_activity.paid_rank,&#13;&#10;    first_activity.dw_updated_dtz&#13;&#10; FROM (&#13;&#10;    SELECT&#13;&#10;        first_spon_as_dist.account_sponsor_id AS account_id,&#13;&#10;        first_spon_as_dist.account_id AS downline_id,&#13;&#10;        first_dist_order.commissionable_date AS activity_date,&#13;&#10;        date_trunc('month', first_dist_order.commissionable_date)::DATE AS activity_month,&#13;&#10;        dwaw.activity_id,&#13;&#10;        CASE&#13;&#10;            WHEN first_spon_as_dist.slevel = 1 THEN 'duplication level 1'&#13;&#10;            WHEN first_spon_as_dist.slevel = 2 THEN 'duplication level 2'&#13;&#10;            WHEN first_spon_as_dist.slevel = 3 THEN 'duplication level 3'&#13;&#10;            WHEN first_spon_as_dist.slevel = 4 THEN 'duplication level 4'&#13;&#10;            WHEN first_spon_as_dist.slevel = 5 THEN 'duplication level 5'&#13;&#10;            WHEN first_spon_as_dist.slevel = 6 THEN 'duplication level 6'&#13;&#10;            WHEN first_spon_as_dist.slevel = 7 THEN 'duplication level 7'&#13;&#10;        END AS activity,&#13;&#10;        CASE WHEN first_spon_as_dist.slevel = 1 THEN 'advanced' ELSE 'business building' END AS activity_category,&#13;&#10;        CASE&#13;&#10;            WHEN COALESCE(monthly_order.account_type, '') = '' THEN dst.account_type&#13;&#10;            ELSE monthly_order.account_type&#13;&#10;        END AS retained_account_type,&#13;&#10;    CASE&#13;&#10;        WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_dist_order.commissionable_date, dst.src_created_date)*12) + EXTRACT(month from age(first_dist_order.commissionable_date, dst.src_created_date))&#13;&#10;        WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_dist_order.commissionable_date, dst.src_created_date)*12) + EXTRACT(month from age(first_dist_order.commissionable_date, dst.src_created_date))&#13;&#10;        WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;&#9;&#9;&#9;THEN EXTRACT(year from age(first_dist_order.commissionable_date, dst.src_created_date)*12) + EXTRACT(month from age(first_dist_order.commissionable_date, dst.src_created_date))&#13;&#10;        ELSE &#13;&#10;&#9;&#9;&#9;EXTRACT(year from age(first_dist_order.commissionable_date, initial_order.commissionable_date)*12) + EXTRACT(month from age(first_dist_order.commissionable_date, initial_order.commissionable_date))&#13;&#10;    END AS months_after_signup,&#13;&#10;--        CASE&#13;&#10;--            WHEN dst.src_created_date &lt; date_trunc('month', initial_order.commissionable_date)::DATE&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_dist_order.commissionable_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--            WHEN dst.src_created_date &lt;= '2015-10-31'&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_dist_order.commissionable_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--            WHEN initial_order.account_id BETWEEN 2000000 AND 2999999&#13;&#10;--            THEN ROUND(MONTHS_BETWEEN(date_trunc('month', first_dist_order.commissionable_date), date_trunc('month', dst.src_created_date)::DATE), 0)&#13;&#10;--            ELSE ROUND(MONTHS_BETWEEN(date_trunc('month', first_dist_order.commissionable_date), date_trunc('month', initial_order.commissionable_date)::DATE), 0)&#13;&#10;--        END AS months_after_signup,&#13;&#10;--        DATE_DIFF('day', dst.src_created_date, first_dist_order.commissionable_date) AS days_after_signup,&#13;&#10;--        DATE_DIFF('day', COALESCE(dst.comm_eligible_date, dst.src_created_date), first_dist_order.commissionable_date) AS days_after_comm_eligible,&#13;&#10;    &#9;(CAST (first_dist_order.commissionable_date as date) - CAST (dst.src_created_date as date)) AS days_after_signup,&#13;&#10;    &#9;(CAST (first_dist_order.commissionable_date as date) - CAST (COALESCE(dst.comm_eligible_date, dst.src_created_date) as date)) AS days_after_comm_eligible,&#13;&#10;        bwt.end_rank AS lifetime_rank,&#13;&#10;        bwt.paid_rank AS paid_rank,&#13;&#10;        CURRENT_TIMESTAMP AS dw_updated_dtz,&#13;&#10;        ROW_NUMBER() OVER (PARTITION BY first_spon_as_dist.account_sponsor_id, date_trunc('month', first_dist_order.commissionable_date)::DATE,&#13;&#10;            CASE&#13;&#10;                WHEN first_spon_as_dist.slevel = 1 THEN 'duplication level 1'&#13;&#10;                WHEN first_spon_as_dist.slevel = 2 THEN 'duplication level 2'&#13;&#10;                WHEN first_spon_as_dist.slevel = 3 THEN 'duplication level 3'&#13;&#10;                WHEN first_spon_as_dist.slevel = 4 THEN 'duplication level 4'&#13;&#10;                WHEN first_spon_as_dist.slevel = 5 THEN 'duplication level 5'&#13;&#10;                WHEN first_spon_as_dist.slevel = 6 THEN 'duplication level 6'&#13;&#10;                WHEN first_spon_as_dist.slevel = 7 THEN 'duplication level 7'&#13;&#10;            END&#13;&#10;            ORDER BY first_dist_order.commissionable_date) AS rn&#13;&#10;    FROM (&#13;&#10;    --First order placed as a type 'D' account&#13;&#10;        SELECT&#13;&#10;            account_id,&#13;&#10;            commissionable_date,&#13;&#10;            ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date) AS rn&#13;&#10;        FROM&#13;&#10;            dw_orders&#13;&#10;        WHERE&#13;&#10;            order_status BETWEEN 2 AND 8&#13;&#10;            AND is_fraud IS FALSE&#13;&#10;            AND account_type = 'D'&#13;&#10;        ) first_dist_order&#13;&#10;    --Accounts sponsoring, levels 1 - 4, at the time of their first account type 'D' order&#13;&#10;        INNER JOIN (&#13;&#10;            SELECT&#13;&#10;                account_sponsor_id,&#13;&#10;                account_id,&#13;&#10;                slevel,&#13;&#10;                effective_from_dtz_pt,&#13;&#10;                effective_to_dtz_pt&#13;&#10;            FROM&#13;&#10;                dw_enrollment_history&#13;&#10;            WHERE&#13;&#10;                slevel BETWEEN 1 AND 7&#13;&#10;                AND account_sponsor_id &gt; 5&#13;&#10;            ) first_spon_as_dist ON first_dist_order.account_id = first_spon_as_dist.account_id&#13;&#10;                AND first_dist_order.commissionable_date BETWEEN first_spon_as_dist.effective_from_dtz_pt AND first_spon_as_dist.effective_to_dtz_pt&#13;&#10;    --Getting account type on dw_accounts table&#13;&#10;        INNER JOIN dw_accounts dst ON first_spon_as_dist.account_sponsor_id = dst.account_id&#13;&#10;    --Initial Order&#13;&#10;        LEFT JOIN (&#13;&#10;            SELECT&#13;&#10;                commissionable_date,&#13;&#10;                account_id,&#13;&#10;                ROW_NUMBER() OVER (PARTITION BY account_id ORDER BY commissionable_date, order_id) AS rn&#13;&#10;            FROM&#13;&#10;                dw_orders&#13;&#10;            WHERE&#13;&#10;                order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;            ORDER BY&#13;&#10;                account_id,&#13;&#10;                commissionable_date&#13;&#10;            ) initial_order ON first_spon_as_dist.account_sponsor_id = initial_order.account_id AND initial_order.rn = 1&#13;&#10;    --Monthly Order&#13;&#10;        LEFT JOIN (&#13;&#10;            SELECT&#13;&#10;                commissionable_date,&#13;&#10;                account_id,&#13;&#10;                account_type,&#13;&#10;                ROW_NUMBER() OVER (PARTITION BY account_id, date_trunc('month', commissionable_date) ORDER BY commissionable_date DESC, order_id) AS rn&#13;&#10;            FROM&#13;&#10;                dw_orders&#13;&#10;            WHERE&#13;&#10;                order_status BETWEEN 2 AND 8 AND is_fraud IS FALSE AND account_id &gt; 5 AND account_id NOT IN (11000008)&#13;&#10;            ORDER BY&#13;&#10;                account_id,&#13;&#10;                commissionable_date&#13;&#10;            ) monthly_order ON first_spon_as_dist.account_sponsor_id = monthly_order.account_id&#13;&#10;                AND date_trunc('month', first_dist_order.commissionable_date) = date_trunc('month', monthly_order.commissionable_date)&#13;&#10;                AND monthly_order.rn = 1&#13;&#10;        LEFT JOIN dw_activity_weight dwaw ON dwaw.activity =&#13;&#10;            CASE&#13;&#10;                WHEN first_spon_as_dist.slevel = 1 THEN 'duplication level 1'&#13;&#10;                WHEN first_spon_as_dist.slevel = 2 THEN 'duplication level 2'&#13;&#10;                WHEN first_spon_as_dist.slevel = 3 THEN 'duplication level 3'&#13;&#10;                WHEN first_spon_as_dist.slevel = 4 THEN 'duplication level 4'&#13;&#10;                WHEN first_spon_as_dist.slevel = 5 THEN 'duplication level 5'&#13;&#10;                WHEN first_spon_as_dist.slevel = 6 THEN 'duplication level 6'&#13;&#10;                WHEN first_spon_as_dist.slevel = 7 THEN 'duplication level 7'&#13;&#10;            END&#13;&#10;        LEFT JOIN bwtdb bwt ON first_spon_as_dist.account_id = bwt.dist_id&#13;&#10;            AND TO_CHAR(first_dist_order.commissionable_date, 'YYYYMM') = bwt.dw_pv_date::char(6)&#13;&#10;    WHERE&#13;&#10;        first_dist_order.rn = 1&#13;&#10;        AND first_dist_order.commissionable_date &gt;= date_trunc('month', CURRENT_DATE) - interval '1 month'&#13;&#10;    ORDER BY&#13;&#10;        first_spon_as_dist.account_sponsor_id,&#13;&#10;        first_dist_order.commissionable_date&#13;&#10;    ) first_activity&#13;&#10;WHERE&#13;&#10;    first_activity.rn = 1&#13;&#10;ORDER BY&#13;&#10;    first_activity.account_id,&#13;&#10;    first_activity.activity_date&#13;&#10;&quot;"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_CURSOR" value="false"/>
    <elementParameter field="TEXT" name="CURSOR_SIZE" show="false" value="1000"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="TRIM" value="false"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="dw_account_activity_duplication"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBInput_18">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
  </node>
  <node componentName="tPostgresqlOutput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="704">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBOutput_18"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="V9_X"/>
    <elementParameter field="TEXT" name="HOST" value="context.Aurora_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Aurora_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Aurora_Database"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Aurora_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Aurora_Login"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:SYogWd57ytseBDzGOnlzCZvAE/xsWY55oBnyxLmx2i6mcpdD4KaNXVTtPHpyUbQqVXBA"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;dw_account_activity&quot;"/>
    <elementParameter field="CLOSED_LIST" name="TABLE_ACTION" value="NONE"/>
    <elementParameter field="CLOSED_LIST" name="DATA_ACTION" value="INSERT_OR_UPDATE"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:SCHEMA_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="SCHEMA_FLOW:REPOSITORY_SCHEMA_TYPE" show="false" value="_7RjOUBMcEeuSi67XXGFvgw - dw_account_activity"/>
    <elementParameter field="CHECK" name="USE_SPATIAL_OPTIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="SPATIAL_INDEX" show="false" value="false"/>
    <elementParameter field="CHECK" name="GEOMETRY_COLUMNS" show="false" value="false"/>
    <elementParameter field="LABEL" name="NOTE" value="This option only applies when deploying and running in the Talend Runtime"/>
    <elementParameter field="CHECK" name="SPECIFY_DATASOURCE_ALIAS" value="false"/>
    <elementParameter field="TEXT" name="DATASOURCE_ALIAS" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="false"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="postgres_id"/>
    <elementParameter field="CHECK" name="USE_ALTERNATE_SCHEMA" show="false" value="false"/>
    <elementParameter field="TEXT" name="ALTERNATE_SCHEMA" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.Aurora_AdditionalParams"/>
    <elementParameter field="CHECK" name="SAVE_POINT" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TABLE" name="ADD_COLS"/>
    <elementParameter field="CHECK" name="USE_FIELD_OPTIONS" value="false"/>
    <elementParameter field="TABLE" name="FIELD_OPTIONS" show="false">
      <elementValue elementRef="SCHEMA_COLUMN" value="account_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_date"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_month"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_id"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="activity_category"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="retained_account_type"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="months_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_signup"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="days_after_eligible"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="lifetime_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="paid_rank"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
      <elementValue elementRef="SCHEMA_COLUMN" value="dw_updated_dtz"/>
      <elementValue elementRef="UPDATE_KEY" value="false"/>
      <elementValue elementRef="DELETE_KEY" value="false"/>
      <elementValue elementRef="UPDATABLE" value="true"/>
      <elementValue elementRef="INSERTABLE" value="true"/>
    </elementParameter>
    <elementParameter field="CHECK" name="ENABLE_DEBUG_MODE" value="false"/>
    <elementParameter field="CHECK" name="SUPPORT_NULL_WHERE" value="false"/>
    <elementParameter field="CHECK" name="CONVERT_COLUMN_TABLE_TO_LOWERCASE" value="false"/>
    <elementParameter field="CHECK" name="USE_BATCH_SIZE" show="false" value="true"/>
    <elementParameter field="TEXT" name="BATCH_SIZE" show="false" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="__TABLE__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" label="dw_account_activity" name="tDBOutput_18">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
    </metadata>
    <metadata connector="REJECT" label="dw_account_activity" name="REJECT">
      <column comment="" key="true" length="19" name="account_id" nullable="false" pattern="" precision="0" sourceType="INT8" type="id_Long" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="13" name="activity_date" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="13" name="activity_month" nullable="false" pattern="&quot;dd-MM-yyyy&quot;" precision="0" sourceType="DATE" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="activity_id" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="true" length="40" name="activity" nullable="false" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="30" name="activity_category" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="3" name="retained_account_type" nullable="true" pattern="" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="months_after_signup" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_signup" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="10" name="days_after_eligible" nullable="true" pattern="" precision="0" sourceType="INT4" type="id_Integer" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="lifetime_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="5" name="paid_rank" nullable="true" pattern="" precision="0" sourceType="INT2" type="id_Short" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column comment="" key="false" length="35" name="dw_updated_dtz" nullable="true" pattern="&quot;dd-MM-yyyy&quot;" precision="6" sourceType="TIMESTAMPTZ" type="id_Date" usefulColumn="true">
        <additionalField key="Comment" value=""/>
      </column>
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="VARCHAR" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <connection connectorName="FLOW" label="row1" lineStyle="0" metaname="tDBInput_1" offsetLabelX="0" offsetLabelY="0" source="tDBInput_1" target="tDBOutput_1">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row1"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_1" offsetLabelX="0" offsetLabelY="0" source="tDBInput_1" target="tDBInput_2">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk1"/>
  </connection>
  <connection connectorName="FLOW" label="row2" lineStyle="0" metaname="tDBInput_2" offsetLabelX="0" offsetLabelY="0" source="tDBInput_2" target="tDBOutput_2">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row2"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_2" offsetLabelX="0" offsetLabelY="0" source="tDBInput_2" target="tDBInput_3">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk2"/>
  </connection>
  <connection connectorName="FLOW" label="row3" lineStyle="0" metaname="tDBInput_3" offsetLabelX="0" offsetLabelY="0" source="tDBInput_3" target="tDBOutput_3">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row3"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_3" offsetLabelX="0" offsetLabelY="0" source="tDBInput_3" target="tDBInput_4">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk3"/>
  </connection>
  <connection connectorName="FLOW" label="row4" lineStyle="0" metaname="tDBInput_4" offsetLabelX="0" offsetLabelY="0" source="tDBInput_4" target="tDBOutput_4">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row4"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_4" offsetLabelX="0" offsetLabelY="0" source="tDBInput_4" target="tDBInput_5">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk4"/>
  </connection>
  <connection connectorName="FLOW" label="row5" lineStyle="0" metaname="tDBInput_5" offsetLabelX="0" offsetLabelY="0" source="tDBInput_5" target="tDBOutput_5">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row5"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_5" offsetLabelX="0" offsetLabelY="0" source="tDBInput_5" target="tDBInput_6">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk5"/>
  </connection>
  <connection connectorName="FLOW" label="row6" lineStyle="0" metaname="tDBInput_6" offsetLabelX="0" offsetLabelY="0" source="tDBInput_6" target="tDBOutput_6">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row6"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_6" offsetLabelX="0" offsetLabelY="0" source="tDBInput_6" target="tDBInput_7">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk6"/>
  </connection>
  <connection connectorName="FLOW" label="row7" lineStyle="0" metaname="tDBInput_7" offsetLabelX="0" offsetLabelY="0" source="tDBInput_7" target="tDBOutput_7">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row7"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_7" offsetLabelX="0" offsetLabelY="0" source="tDBInput_7" target="tDBInput_8">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk7"/>
  </connection>
  <connection connectorName="FLOW" label="row8" lineStyle="0" metaname="tDBInput_8" offsetLabelX="0" offsetLabelY="0" source="tDBInput_8" target="tDBOutput_8">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row8"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_8" offsetLabelX="0" offsetLabelY="0" source="tDBInput_8" target="tDBInput_9">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk8"/>
  </connection>
  <connection connectorName="FLOW" label="row9" lineStyle="0" metaname="tDBInput_9" offsetLabelX="0" offsetLabelY="0" source="tDBInput_9" target="tDBOutput_9">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row9"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_9" offsetLabelX="0" offsetLabelY="0" source="tDBInput_9" target="tDBInput_10">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk9"/>
  </connection>
  <connection connectorName="FLOW" label="row10" lineStyle="0" metaname="tDBInput_10" offsetLabelX="0" offsetLabelY="0" source="tDBInput_10" target="tDBOutput_10">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row10"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_10" offsetLabelX="0" offsetLabelY="0" source="tDBInput_10" target="tDBInput_11">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk10"/>
  </connection>
  <connection connectorName="FLOW" label="row11" lineStyle="0" metaname="tDBInput_11" offsetLabelX="0" offsetLabelY="0" source="tDBInput_11" target="tDBOutput_11">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row11"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_11" offsetLabelX="0" offsetLabelY="0" source="tDBInput_11" target="tDBInput_12">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk11"/>
  </connection>
  <connection connectorName="FLOW" label="row12" lineStyle="0" metaname="tDBInput_12" offsetLabelX="0" offsetLabelY="0" source="tDBInput_12" target="tDBOutput_12">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row12"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_12" offsetLabelX="0" offsetLabelY="0" source="tDBInput_12" target="tDBInput_13">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk12"/>
  </connection>
  <connection connectorName="FLOW" label="row13" lineStyle="0" metaname="tDBInput_13" offsetLabelX="0" offsetLabelY="0" source="tDBInput_13" target="tDBOutput_13">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row13"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_13" offsetLabelX="0" offsetLabelY="0" source="tDBInput_13" target="tDBInput_14">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk13"/>
  </connection>
  <connection connectorName="FLOW" label="row14" lineStyle="0" metaname="tDBInput_14" offsetLabelX="0" offsetLabelY="0" source="tDBInput_14" target="tDBOutput_14">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row14"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_14" offsetLabelX="0" offsetLabelY="0" source="tDBInput_14" target="tDBInput_15">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk14"/>
  </connection>
  <connection connectorName="FLOW" label="row15" lineStyle="0" metaname="tDBInput_15" offsetLabelX="0" offsetLabelY="0" source="tDBInput_15" target="tDBOutput_15">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row15"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_15" offsetLabelX="0" offsetLabelY="0" source="tDBInput_15" target="tDBInput_16">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk15"/>
  </connection>
  <connection connectorName="FLOW" label="row16" lineStyle="0" metaname="tDBInput_16" offsetLabelX="0" offsetLabelY="0" source="tDBInput_16" target="tDBOutput_16">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row16"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_16" offsetLabelX="0" offsetLabelY="0" source="tDBInput_16" target="tDBInput_17">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk16"/>
  </connection>
  <connection connectorName="FLOW" label="row17" lineStyle="0" metaname="tDBInput_17" offsetLabelX="0" offsetLabelY="0" source="tDBInput_17" target="tDBOutput_17">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row17"/>
  </connection>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tDBInput_17" offsetLabelX="0" offsetLabelY="0" source="tDBInput_17" target="tDBInput_18">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnSubjobOk17"/>
  </connection>
  <connection connectorName="FLOW" label="row18" lineStyle="0" metaname="tDBInput_18" offsetLabelX="0" offsetLabelY="0" source="tDBInput_18" target="tDBOutput_18">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row18"/>
  </connection>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_2"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_3"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_4"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_5"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_6"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_7"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_8"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_9"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_10"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_11"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_12"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_13"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_14"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_15"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_16"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_17"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_18"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" show="false" value="92;131;150"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#" Id="_4266df17-ecf1-4db2-a33e-d1ae08b24e7e"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/><SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"/><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>VvCo6rQyHjFMe2rPUesWnXQ7fQAo8OU8cvSseWAFSjpHBr4eTDMKxsevUq9dJ0L3/hxXFmrRFDMU
3QBrM+GaiQ==</DigestValue></Reference><Reference Type="http://www.w3.org/2000/09/xmldsig#SignatureProperties" URI="#_69bce2ce-49b2-4544-97b2-9e5210a06209"><Transforms><Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>Ib7uptpHNABkGctT1rUPIyWEaB97pbZxQq4Tk6eaoYa6pENN2sCwNN/pBDIn1UuzRMDH/F2MBcF8
h++gnDiafA==</DigestValue></Reference></SignedInfo><SignatureValue>UuwrZ2MaIUQ+Xmy2fpeqxCY0LPggl6C1/pKn9VLPp0cdZAMppabSzR+VMFRtrA3rjHNRjsMJvJ8g
mcbqcLuF3giEnB77Ksrc9DHy17PpbHQ/c4GXGJ/Tp42NENNj1b4fGdVi33RGAybT3UUaWjhmzUQ9
oMBkuXLl1vrfCXoz1Fy9WQKY44xqJVY5mcF2vDqmdkKbd39k36nO+iddnSTsvu6nEO4+8K6fR8U0
6nYZ4cP3UvLxdzhom9+m+w2URjHqCBSMWQOQ12Bso9hwajCubiCJNngnohPriMAQDs9yFGqUAlPe
Y8KYQKN3NmcCqrdnldBiLkn3dnORp/GtvFgw1w==</SignatureValue><KeyInfo><X509Data><X509SubjectName>C=FR,ST=Paris,L=Paris,O=Talend Inc.,OU=R&amp;D,CN=Talend Code Signing certificate</X509SubjectName><X509Certificate>MIIFADCCAuigAwIBAgIIA2OsD6bRyj0wDQYJKoZIhvcNAQELBQAwgY0xCzAJBgNVBAYTAkZSMQ4w
DAYDVQQIEwVQYXJpczEOMAwGA1UEBxMFUGFyaXMxFDASBgNVBAoTC1RhbGVuZCBJbmMuMQwwCgYD
VQQLDANSJkQxFjAUBgNVBAMMDVRhbGVuZCBSJkQgQ0ExIjAgBgkqhkiG9w0BCQEWE3NlY3VyaXR5
QHRhbGVuZC5jb20wHhcNMTkwNjAzMDgxODIwWhcNMjkwNjAzMDAwMDAwWjB7MSgwJgYDVQQDEx9U
YWxlbmQgQ29kZSBTaWduaW5nIGNlcnRpZmljYXRlMQwwCgYDVQQLDANSJkQxFDASBgNVBAoTC1Rh
bGVuZCBJbmMuMQ4wDAYDVQQHEwVQYXJpczEOMAwGA1UECBMFUGFyaXMxCzAJBgNVBAYTAkZSMIIB
IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp5TMF8BmRt8dY51t9kIDdDkoOKVVytJN2gn2
DhMGi8hzpUofNDykJDhe9SPqyJdGZ6o/h7laTA0/CivKyPT1OJQ9E2gMHKs8cTZM/cO2w0Atlqkl
alIxepol0DNnUtmECVBqdnVsJesfmdoeptxgJAtxYbquFsTsrATNY2cscXpwmOca/Ewip48WQLFx
e5s067jaIsAQGRIqpIup3bOtWBySrtImJ40lQCPeEcl96qzkv3utaVaNc3ukkhYkCDbMbK8NVd1B
CVeeIBAe+n/SdpHH20o+6eIiZecsBGDLwlTYrFvuVqAa6xI7y8Vdz6irjPAVBEtG/iOc782aJ/lZ
TwIDAQABo3UwczAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEF
BQcDAzAdBgNVHQ4EFgQUGdfzQEbjQnANq28sfhEMTx+rsOcwHwYDVR0jBBgwFoAU530Lcvy1gZnG
gCvZLOyCczK1qPcwDQYJKoZIhvcNAQELBQADggIBAEr22wnaQwZm2dhbUCqD+qZpTq2AF/tzxqAM
eL/CiTjPbTblS4SNNwCKvTgMe9ucpUbenXmK7xE+DU9dN4om+t3VHbkOLQVyuLcd2WGsy7ZGwRvA
f+TFwLbwjyTukOGm6Sd1qyZgvCPzBsKnft6vscvGy2yEpmFCeHJyBP8pvchg607zguRdNbkGYZXw
G6jNipAbTtzdPTFKKr1bEf0sUGqMrlZIMPjflh2Vewu8ImNdX5IZdvBD6DdFVOC5wqV6u+W9ukE/
mXZxDBYNl2AF7FTh04ucEVN3mHv7m2L0uFvUlhxchcagJhJsdQG+A0LVCemHbp6CSNQJx02KxqUG
hakvpzhOyLo91h8YAQrEZJdNuKA8IYmBrFZQZDCz0uywKSyFfzPyJhvxylCLG/iDPPfE0VWcrMJ/
WQJly/2XPg/NBCTF3pSKS0kCiA7PeaI3cWkMYYA3PMwYDvzqs1opBRglG7ikj0bQxSm3lcjMuuvW
gBRksFKjP3K/nztsjSoYITOM9jR29ReIL3v0E8RbAFwA2RGq6Dxd0ixfbucMesy5Gnr8tfYy6rW+
qSQqd3ah4+PSzBNVwIB4ytpdrG3SlhCI2i2Th8ek8Sjsaquh9qPAerWNd2+84HWOOGj1Xe1qc6vg
qqu6JoK9EXKDiwBqDVkueIa+MhamE1VDnhn2pPui</X509Certificate></X509Data></KeyInfo><Object><SignatureProperties><SignatureProperty Id="_69bce2ce-49b2-4544-97b2-9e5210a06209" Target="#_4266df17-ecf1-4db2-a33e-d1ae08b24e7e"><Timestamp>2023-01-25 17:01:18</Timestamp></SignatureProperty></SignatureProperties></Object></Signature></talendfile:ProcessType>